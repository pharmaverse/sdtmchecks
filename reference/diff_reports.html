<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a sdtmchecks list object with column indicating whether the issue was previously seen — diff_reports • sdtmchecks</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create a sdtmchecks list object with column indicating whether the issue was previously seen — diff_reports"><meta property="og:description" content='This report will identify flagged records from an sdtmchecks report
that are "new" and those that are "old" for a study. This will help quickly target
newly emergent issues that may require a new query or investigation while indicating
issues that were encountered from a prior report and may have already been queried.
This diff_reports() function requires a newer and older set of results from
sdtmchecks::run_all_checks(), which will generate a list of check results.
An added column "Status" is created with values of "NEW" and "OLD"
in the list of check results, flagging whether a given record that is present
in the new result (ie new_report) is also present in the old result (ie old_report).
It makes a difference which report is defined as "new" and "old".
This code only keeps results flagged in the new report and drops
old results not in the new report because they were presumably resolved.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sdtmchecks</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sdtmchecks.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/write_a_check.html">Writing a New Check</a>
    </li>
    <li>
      <a href="../articles/search_checks.html">Search Data Check Functions</a>
    </li>
    <li>
      <a href="../articles/faqs.html">Frequently Asked Questions (FAQs)</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Releases</li>
    <li>
      <a href="../news/index.html#sdtmchecks-0111-light-ice">sdtmchecks 0.1.11</a>
    </li>
    <li>
      <a href="../news/index.html#sdtmchecks-0110-light-ice">sdtmchecks 0.1.10</a>
    </li>
    <li>
      <a href="../news/index.html#sdtmchecks-018-bubble-and-squeak">sdtmchecks 0.1.8</a>
    </li>
    <li>
      <a href="../news/index.html#sdtmchecks-016-bubble-and-squeak">sdtmchecks 0.1.6</a>
    </li>
    <li>
      <a href="../news/index.html#sdtmchecks-015-hunter-pi">sdtmchecks 0.1.5</a>
    </li>
    <li>
      <a href="../news/index.html#sdtmchecks-014-very-cool-nickname">sdtmchecks 0.1.2-0.1.4</a>
    </li>
    <li>
      <a href="../news/index.html#sdtmchecks-011-open-up">sdtmchecks 0.1.1</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/pharmaverse/sdtmchecks" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a sdtmchecks list object with column indicating whether the issue was previously seen</h1>
    <small class="dont-index">Source: <a href="https://github.com/pharmaverse/sdtmchecks/blob/HEAD/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
    <div class="hidden name"><code>diff_reports.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This report will identify flagged records from an sdtmchecks report
that are "new" and those that are "old" for a study. This will help quickly target
newly emergent issues that may require a new query or investigation while indicating
issues that were encountered from a prior report and may have already been queried.</p>
<p>This <code>diff_reports()</code> function requires a newer and older set of results from
<code><a href="run_all_checks.html">sdtmchecks::run_all_checks()</a></code>, which will generate a list of check results.
An added column "Status" is created with values of "NEW" and "OLD"
in the list of check results, flagging whether a given record that is present
in the new result (ie <code>new_report</code>) is also present in the old result (ie <code>old_report</code>).
It makes a difference which report is defined as "new" and "old".
This code only keeps results flagged in the new report and drops
old results not in the new report because they were presumably resolved.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">diff_reports</span><span class="op">(</span><span class="va">old_report</span>, <span class="va">new_report</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>old_report</dt>
<dd><p>an older sdtmchecks list object as created by <code>run_all_checks</code></p></dd>


<dt>new_report</dt>
<dd><p>a newer sdtmchecks list object as created by <code>run_all_checks</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>list of sdtmchecks results based on new_report with Status indicator</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Example programs for running data checks
<code><a href="report_to_xlsx.html">report_to_xlsx</a>()</code>,
<code><a href="run_all_checks.html">run_all_checks</a>()</code>,
<code><a href="run_check.html">run_check</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Step 1: Simular an older AE dataset with one missing preferred term</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">ae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> USUBJID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span> DOMAIN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"AE"</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> AESEQ <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span> AESTDTC <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span> AETERM <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span> AEDECOD <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>  AESPID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FORMNAME-R:13/L:13XXXX"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"FORMNAME-R:16/L:16XXXX"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"FORMNAME-R:2/L:2XXXX"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"FORMNAME-R:19/L:19XXXX"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"FORMNAME-R:5/L:5XXXX"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ae</span><span class="op">$</span><span class="va">AEDECOD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Step 2: Use the run_all_checks() function to generate list of check results on this "old" data</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Filter sdtmchecksmeta so that only one check is present</span></span></span>
<span class="r-in"><span><span class="va">metads</span> <span class="op">&lt;-</span> <span class="va">sdtmchecksmeta</span><span class="op">[</span><span class="va">sdtmchecksmeta</span><span class="op">$</span><span class="va">check</span><span class="op">==</span><span class="st">"check_ae_aedecod"</span>,<span class="op">]</span> </span></span>
<span class="r-in"><span><span class="va">old</span> <span class="op">&lt;-</span> <span class="fu"><a href="run_all_checks.html">run_all_checks</a></span><span class="op">(</span>metads<span class="op">=</span><span class="va">metads</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Domain not found: ae. Checks requiring this domain were not run.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Step 3: Simulate a newer, updated AE dataset with another record with a new missing preferred term</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">ae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> USUBJID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span> DOMAIN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"AE"</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> AESEQ <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span> AESTDTC <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span> AETERM <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span> AEDECOD <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span>  AESPID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FORMNAME-R:13/L:13XXXX"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"FORMNAME-R:16/L:16XXXX"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"FORMNAME-R:2/L:2XXXX"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"FORMNAME-R:19/L:19XXXX"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"FORMNAME-R:5/L:5XXXX"</span>,</span></span>
<span class="r-in"><span>             <span class="st">"FORMNAME-R:1/L:5XXXX"</span></span></span>
<span class="r-in"><span>             <span class="op">)</span>,</span></span>
<span class="r-in"><span> stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ae</span><span class="op">$</span><span class="va">AEDECOD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">ae</span><span class="op">$</span><span class="va">AEDECOD</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Step 4: use the run_all_checks() function to generate list of check results  on this "new" data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">new</span> <span class="op">&lt;-</span> <span class="fu"><a href="run_all_checks.html">run_all_checks</a></span><span class="op">(</span>metads<span class="op">=</span><span class="va">metads</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Domain not found: ae. Checks requiring this domain were not run.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Step 5: Diff to create a column indicating if the finding is new</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">diff_reports</span><span class="op">(</span>old_report<span class="op">=</span><span class="va">old</span>, new_report<span class="op">=</span><span class="va">new</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## optionally output results as spreadsheet with sdtmchecks::report_to_xlsx()</span></span></span>
<span class="r-in"><span><span class="co"># report_to_xlsx(res, outfile=paste0("saved_reports/sdtmchecks_diff_",Sys.Date(),".xlsx"))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Will Harris, Sara Bodach, Edgar Manukyan, Adrian Waddell, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

